<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TorusE2E Daily Build Status</title>
</head>
<body style="font-family: Arial, sans-serif; margin: 0; padding: 20px; background-color: #f5f5f5;">
    <table width="100%" cellpadding="0" cellspacing="0" style="max-width: 600px; margin: 0 auto; background-color: white; border: 1px solid #ddd;">
        <tr>
            <td style="padding: 20px;">
                <h1 style="color: #333; text-align: center; margin: 0 0 20px 0; padding-bottom: 10px; border-bottom: 2px solid #007acc;">TorusE2E Daily Build Status (Windows)</h1>

                <!-- VARIABLES SECTION - FOR PYTHON SCRIPT TO MODIFY -->
                <script type="application/json" id="build-variables">
                {
                    "beta_build_status": "FAILED",
                    "beta_version": "1.0.0-beta.123",
                    "beta_build_link": "https://build-server.com/builds/beta/123",
                    "failed_tests_count": "5",
                    "rebase_tool_summary_link": "https://dashboard.com/rebase-tool/summary",
                    "culprit_finder_summary_link": "https://dashboard.com/culprit-finder/summary"
                }
                </script>
                <!-- END VARIABLES SECTION -->

                <!-- TorusE2E Beta Build Section -->
                <table width="100%" cellpadding="10" cellspacing="0" style="margin-bottom: 15px; border: 1px solid #ddd; background-color: #fafafa;">
                    <tr>
                        <td>
                            <h2 style="color: #007acc; margin: 0 0 10px 0; font-size: 16px;">TorusE2E Beta Build</h2>
                            <div>
                                <strong>Status:</strong> <span id="beta-status" style="color: #28a745; font-weight: bold;">✅ Build Successful</span><br>
                                <span id="beta-version-line"><strong>Version:</strong> <span id="beta-version">1.0.0-beta.123</span><br></span>
                                <strong>Details:</strong> <a id="beta-link" href="https://build-server.com/builds/beta/123" style="color: #007acc;">View Build Details</a>
                            </div>
                        </td>
                    </tr>
                </table>

                <!-- Failed Torus Burn Tests Section -->
                <table id="failed-tests-section" width="100%" cellpadding="10" cellspacing="0" style="margin-bottom: 15px; border: 1px solid #ddd; background-color: #fafafa;">
                    <tr>
                        <td>
                            <h2 style="color: #007acc; margin: 0 0 10px 0; font-size: 16px;">Failed Torus Burn Tests</h2>
                            <div>
                                <strong>Count:</strong> <span id="failed-tests">5</span> failed test(s)
                            </div>
                        </td>
                    </tr>
                </table>

                <!-- Rebase Tool Summary Section -->
                <table id="rebase-tool-section" width="100%" cellpadding="10" cellspacing="0" style="margin-bottom: 15px; border: 1px solid #ddd; background-color: #fafafa;">
                    <tr>
                        <td>
                            <h2 style="color: #007acc; margin: 0 0 10px 0; font-size: 16px;">Rebase Tool Summary</h2>
                            <div>
                                <a id="rebase-tool-link" href="https://dashboard.com/rebase-tool/summary" style="color: #007acc;">View Rebase Tool Summary</a>
                            </div>
                        </td>
                    </tr>
                </table>

                <!-- Culprit Finder Summary Section -->
                <table id="culprit-finder-section" width="100%" cellpadding="10" cellspacing="0" style="margin-bottom: 15px; border: 1px solid #ddd; background-color: #fafafa;">
                    <tr>
                        <td>
                            <h2 style="color: #007acc; margin: 0 0 10px 0; font-size: 16px;">Culprit Finder Summary</h2>
                            <div>
                                <a id="culprit-finder-link" href="https://dashboard.com/culprit-finder/summary" style="color: #007acc;">View Culprit Finder Summary</a>
                            </div>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>

    <script>
        // JavaScript to populate the HTML with variables
        function updateDashboard() {
            const variables = JSON.parse(document.getElementById('build-variables').textContent);
            
            // Update beta build status
            const betaStatusElement = document.getElementById('beta-status');
            const betaVersionElement = document.getElementById('beta-version');
            const betaVersionLine = document.getElementById('beta-version-line');
            const betaLinkElement = document.getElementById('beta-link');
            const failedTestsElement = document.getElementById('failed-tests');
            
            // Get section elements
            const failedTestsSection = document.getElementById('failed-tests-section');
            const rebaseToolSection = document.getElementById('rebase-tool-section');
            const culpritFinderSection = document.getElementById('culprit-finder-section');
            
            if (variables.beta_build_status === 'FAILED') {
                betaStatusElement.innerHTML = '❌ Build Failed';
                betaStatusElement.style.color = '#dc3545';
                betaVersionLine.style.display = 'none'; // Hide the entire version line
                betaLinkElement.href = variables.beta_build_link || '#';
                
                // Hide sections that are not relevant when beta build fails
                failedTestsSection.style.display = 'none';
                rebaseToolSection.style.display = 'none';
                culpritFinderSection.style.display = 'none';
            } else {
                betaStatusElement.innerHTML = '✅ Build Successful';
                betaStatusElement.style.color = '#28a745';
                betaVersionLine.style.display = ''; // Show the version line
                betaVersionElement.textContent = variables.beta_version;
                betaLinkElement.href = variables.beta_build_link;
                failedTestsElement.textContent = variables.failed_tests_count;
                failedTestsElement.style.color = '';
                failedTestsElement.style.fontStyle = '';
                
                // Show sections when beta build is successful
                failedTestsSection.style.display = '';
                rebaseToolSection.style.display = '';
                culpritFinderSection.style.display = '';
                
                // Update links
                document.getElementById('rebase-tool-link').href = variables.rebase_tool_summary_link;
                document.getElementById('culprit-finder-link').href = variables.culprit_finder_summary_link;
            }
        }
        
        // Initialize dashboard on page load
        document.addEventListener('DOMContentLoaded', updateDashboard);
    </script>
</body>
</html>
